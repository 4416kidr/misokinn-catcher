# 前提

python のいくつかパッケージを入れる上で必要なパッケージ管理ツール pip が導入されているのか確認してください．

## 仮想環境の構築

[参考](https://www.python.jp/install/windows/venv.html)

プロジェクトディレクトリを作成後、バックエンド用のディレクトリ（flask_back など）を作成してください。<br/>
その後、バックエンド用のディレクトリで以下のコマンドで仮想環境を作成してください。

```
python -m venv .venv
```

その後、以下のコマンドを実行し、仮想環境に入ってください。

```
.venv\Scripts\activate.bat
```

コマンド プロンプトの先頭に `.venv` と表示され、仮想環境で実行中であることを示します。

## パッケージのインストール

仮想環境内で下記のコマンドを実行し、パッケージのインストールしてください

```
python -m pip install -r requirements.txt
```

## DB

MySQL を用いています。以下のサイトの手順通りにインストールしてください<br/>
[windows の方](https://prog-8.com/docs/mysql-env-win)<br/>
[mac の方](https://prog-8.com/docs/mysql-env)

### テストデータ作成

MySQL の root ユーザにログイン

```
mysql --user=root --password
```

下記コマンドでデータベース`seven_eleven`を作成し、選択。

```
CREATE DATABASE seven_eleven;
USE seven_eleven;
```

テーブル`reviews`,`location`,`stock_status` を作成します。

- location テーブル<br/>
  店舗の位置情報を緯度経度で管理
- reviews テーブル<br/>
  レビューを管理。店舗が選択されたときに表示する。
- stock_status テーブル<br/>
  当該店舗がルート選択できるかどうかを管理する。（最新の投稿で在庫情報が 0 であれば選択できないようにする。）

### location テーブル作成

```
CREATE TABLE location (
    id INT NOT NULL ,
    lat DOUBLE NOT NULL,
    lon DOUBLE NOT NULL,
    PRIMARY KEY (id)
);
```

```
INSERT INTO location (id, lat, lon) VALUES
(1, 34.6680491, 135.5058418),
(2, 34.6683542, 135.5164123),
(3, 34.6902451, 135.5199256),
(4, 34.6790606, 135.5025459),
(5, 34.6841072, 135.5076279),
(6, 34.682091, 135.5149616),
(7, 34.6840742, 135.5002261),
(8, 34.6702321, 135.5059983),
(9, 34.6702487, 135.5006644),
(10, 34.6742249, 135.5166333),
(11, 34.6762739, 135.5045713),
(12, 34.6813379, 135.4980968),
(13, 34.6698054, 135.503577),
(14, 34.6748448, 135.5056577),
(15, 34.6794083, 135.5061364),
(16, 34.6636359, 135.5029694),
(17, 34.6874869, 135.5025554),
(18, 34.669304, 135.5113706),
(19, 34.6879714, 135.5040926),
(20, 34.6764753, 135.5065968),
(21, 34.6848122, 135.5161544),
(22, 34.688806, 135.508411),
(23, 34.6819931, 135.500392),
(24, 34.681353, 135.5081705),
(25, 34.6836031, 135.5177199),
(26, 34.6938115, 135.5341148),
(27, 34.6824926, 135.5046449),
(28, 34.6769007, 135.4986795),
(29, 34.6832182, 135.5129131),
(30, 34.6808687, 135.5338569),
(31, 34.6677278, 135.5064004),
(32, 34.686612, 135.5044608),
(33, 34.6832093, 135.5158045),
(34, 34.680938, 135.5013432),
(35, 34.6750266, 135.5277588),
(36, 34.6887237, 135.5128581),
(37, 34.676588, 135.4990386),
(38, 34.669702, 135.5049396),
(39, 34.6890277, 135.5029142),
(40, 34.6755761, 135.5319105),
(41, 34.6737558, 135.4987164),
(42, 34.6763023, 135.5022145),
(43, 34.6811654, 135.5145705),
(44, 34.6746443, 135.5035586),
(45, 34.6790752, 135.5085486),
(46, 34.6636989, 135.5041799),
(47, 34.6765053, 135.5035418),
(48, 34.687053, 135.4995264),
(49, 34.6865261, 135.509451),
(50, 34.6682053, 135.4997121),
(51, 34.6769007, 135.4986795),
(52, 34.68565299999999, 135.499094),
(53, 34.69013210000001, 135.5155006),
(54, 34.6788773, 135.5141285),
(55, 34.6823459, 135.5002076),
(56, 34.6888035, 135.5163315),
(57, 34.6693746, 135.4978971),
(58, 34.6839537, 135.5057906),
(59, 34.6827587, 135.5073836),
(60, 34.6763072, 135.5181113),
(61, 34.6640599, 135.5014688),
(62, 34.676857, 135.5052502),
(63, 34.677745, 135.5021247),
(64, 34.6748171, 135.5010806),
(65, 34.6914306, 135.5072232),
(66, 34.672096, 135.5146068),
(67, 34.6912027, 135.5314618),
(68, 34.688806, 135.508411),
(69, 34.680662, 135.5337095),
(70, 34.6860122, 135.5156234),
(71, 34.6837828, 135.5071492),
(72, 34.6900376, 135.4978482),
(73, 34.6676945, 135.5091706),
(74, 34.6646715, 135.5107364),
(75, 34.690768, 135.5048972),
(76, 34.6910332, 135.5014165),
(77, 34.6660305, 135.5089353),
(78, 34.6837828, 135.5071492),
(79, 34.6875145, 135.5012559),
(80, 34.6640599, 135.5014688),
(81, 34.6640599, 135.5014688),
(82, 34.6846195, 135.5011098);

```

### reviews テーブル作成

```
CREATE TABLE reviews (
    reviews_id INT PRIMARY KEY,
    store_id INT,
    stock INT,
    post_time DATETIME,
    review TEXT
);
```

日本語対応

```
ALTER TABLE Reviews MODIFY review TEXT CHARACTER SET utf8mb4;
```

```
INSERT INTO reviews (reviews_id, store_id, stock, post_time, review) VALUES
(1, 1, 0, '2023-09-08 10:00:00', '素晴らしい商品です！'),
(2, 2, 1, '2023-09-08 10:05:00', '普通の体験でした。'),
(3, 3, 2, '2023-09-08 10:10:00', '品質に満足していません。'),
(4, 4, 0, '2023-09-08 10:15:00', 'サービスがとても良い！'),
(5, 5, 1, '2023-09-08 10:20:00', 'また利用したいです。'),
(6, 6, 2, '2023-09-08 10:25:00', '価格に見合った品質だと思います。'),
(7, 7, 0, '2023-09-08 10:30:00', '期待以上の商品でした。'),
(8, 8, 1, '2023-09-08 10:35:00', '配送が早くて助かりました。'),
(9, 9, 2, '2023-09-08 10:40:00', '商品の説明と異なる部分がありました。'),
(10, 10, 0, '2023-09-08 10:45:00', 'サポートが非常に親切でした。'),
(11, 7, 0, '2023-09-08 11:00:00', '全体的に満足しています。');
```

## 接続したい DB への情報

/config/env.py に接続したい DB への接続情報を乗せています。ユーザー名とパスワードを自身のものに変更してください。

## id と店舗との対応

location テーブルの id、
review テーブルの store_id は以下の店舗と紐づいています。画面表示などで使用してください。

```javascript
const store_id = {
  1: "セブンイレブン 大阪日本橋駅前店",
  2: "セブンイレブン 大阪谷町9丁目店",
  3: "セブンイレブン 大阪大手前1丁目店",
  4: "セブンイレブン 大阪南久宝寺町3丁目店",
  5: "セブンイレブン 大阪安土町1丁目店",
  6: "セブンイレブン 大阪常盤町1丁目店",
  7: "セブンイレブン 御堂ビル店",
  8: "セブンイレブン 大阪宗右衛門町東店",
  9: "セブンイレブン 御堂筋三ツ寺店",
  10: "セブンイレブン 大阪谷町6丁目店",
  11: "セブンイレブン クリスタ長堀店",
  12: "セブンイレブン 大阪久太郎町4丁目店",
  13: "セブンイレブン ホリデイ・イン大阪難波店",
  14: "セブンイレブン 大阪長堀心斎橋店",
  15: "セブンイレブン 大阪南久宝寺町2丁目店",
  16: "セブンイレブン 大阪難波なんさん通り店",
  17: "セブンイレブン 大阪平野町3丁目店",
  18: "セブンイレブン 大阪瓦屋町3丁目店",
  19: "セブンイレブン 大阪平野町2丁目店",
  20: "セブンイレブン 大阪南船場1丁目店",
  21: "セブンイレブン 大阪谷町2丁目店",
  22: "セブンイレブン 大阪道修町1丁目店",
  23: "セブンイレブン 大阪本町駅中央店",
  24: "セブンイレブン 大阪久太郎町1丁目店",
  25: "セブンイレブン 大阪谷町3丁目店",
  26: "セブンイレブン 大阪ビジネスパーク東店",
  27: "セブンイレブン 大阪南本町2丁目店",
  28: "セブンイレブン クリスタ長堀ウエストタウン店",
  29: "セブンイレブン 大阪内本町2丁目店",
  30: "セブンイレブン ハートインJR森ノ宮駅北口店",
  31: "セブンイレブン 大阪日本橋駅東店",
  32: "セブンイレブン 大阪淡路町2丁目店",
  33: "セブンイレブン 大阪内本町1丁目店",
  34: "セブンイレブン 船場心斎橋筋店",
  35: "セブンイレブン 大阪玉造2丁目店",
  36: "セブンイレブン 大阪島町2丁目店",
  37: "セブンイレブン 大阪南船場4丁目店",
  38: "セブンイレブン 大阪宗右衛門町店",
  39: "セブンイレブン 大阪伏見町3丁目店",
  40: "セブンイレブン 大阪玉造1丁目店",
  41: "セブンイレブン 大阪西心斎橋1丁目店",
  42: "セブンイレブン クリスタ長堀セントラル店",
  43: "セブンイレブン 大阪農人橋1丁目店",
  44: "セブンイレブン 大阪東心斎橋1丁目店",
  45: "セブンイレブン 大阪南久宝寺町1丁目店",
  46: "セブンイレブン 難波千日前店",
  47: "セブンイレブン 南船場三休橋筋店",
  48: "セブンイレブン 大阪淡路町4丁目店",
  49: "セブンイレブン 大阪大手橋前店",
  50: "セブンイレブン 大阪道頓堀2丁目店",
  51: "セブンイレブン 心斎橋長堀通西店",
  52: "セブンイレブン 大阪瓦町4丁目店",
  53: "セブンイレブン 大阪天満橋京町店",
  54: "セブンイレブン 大阪内久宝寺町4丁目店",
  55: "セブンイレブン 御堂筋本町店",
  56: "セブンイレブン 大阪島町1丁目店",
  57: "セブンイレブン 大阪西心斎橋2丁目店",
  58: "セブンイレブン 大阪堺筋本町店",
  59: "セブンイレブン 堺筋本町南店",
  60: "セブンイレブン 大阪安堂寺町1丁目店",
  61: "セブンイレブン なんばスカイオ店",
  62: "セブンイレブン 大阪南船場2丁目店",
  63: "セブンイレブン 大阪南船場3丁目店",
  64: "セブンイレブン 心斎橋駅前店",
  65: "セブンイレブン 大阪証券取引所ビル店",
  66: "セブンイレブン 大阪谷町7丁目店",
  67: "セブンイレブン 読売テレビ店",
  68: "セブンイレブン 北浜道修町通店",
  69: "セブンイレブン 大阪森ノ宮中央1丁目店",
  70: "セブンイレブン 大阪大手通1丁目店",
  71: "セブンイレブン 大阪堺筋本町駅前店",
  72: "セブンイレブン 大阪高麗橋4丁目店",
  73: "セブンイレブン 大阪高津2丁目店",
  74: "セブンイレブン 大阪高津3丁目店",
  75: "セブンイレブン 大阪今橋2丁目店",
  76: "セブンイレブン 日本生命本店東館店",
  77: "セブンイレブン 大阪日本橋1丁目店",
  78: "セブンイレブン 大阪堺筋本町駅前店",
  79: "セブンイレブン 御堂筋平野町店",
  80: "セブンイレブン 南海なんば駅中央口店",
  81: "セブンイレブン 南海なんば駅ガレリア店",
  82: "セブンイレブン 本町ガーデンシティテラス店",
};
```
